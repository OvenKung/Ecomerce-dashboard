import { PrismaClient } from '@prisma/client'
import { hash } from 'bcryptjs'

const prisma = new PrismaClient()

async function main() {
  console.log('üå± ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô seeding ‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...')

  // ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡πà‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
  console.log('üóëÔ∏è ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡πà‡∏≤...')
  await prisma.orderCoupon.deleteMany()
  await prisma.orderItem.deleteMany()
  await prisma.payment.deleteMany()
  await prisma.order.deleteMany()
  await prisma.customer.deleteMany()
  await prisma.productImage.deleteMany()
  await prisma.product.deleteMany()
  await prisma.category.deleteMany()
  await prisma.brand.deleteMany()
  await prisma.coupon.deleteMany()
  await prisma.userRole_Mapping.deleteMany()
  await prisma.rolePermission.deleteMany()
  await prisma.user.deleteMany()
  await prisma.role.deleteMany()
  await prisma.permission.deleteMany()
  console.log('‚úÖ ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡πà‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß')

  // ‡∏™‡∏£‡πâ‡∏≤‡∏á Users
  const hashedPassword = await hash('admin123', 12)
  
  const adminUser = await prisma.user.create({
    data: {
      name: '‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö',
      email: 'admin@example.com',
      password: hashedPassword,
      role: 'ADMIN'
    }
  })

  const managerUser = await prisma.user.create({
    data: {
      name: '‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£',
      email: 'manager@example.com',
      password: hashedPassword,
      role: 'MANAGER'
    }
  })

  const staffUser = await prisma.user.create({
    data: {
      name: '‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô',
      email: 'staff@example.com',
      password: hashedPassword,
      role: 'STAFF'
    }
  })

  console.log('‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß')

  // ‡∏™‡∏£‡πâ‡∏≤‡∏á Categories
  const categories = await Promise.all([
    prisma.category.create({
      data: {
        name: '‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤',
        slug: 'clothing',
        description: '‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤‡πÅ‡∏•‡∏∞‡πÅ‡∏ü‡∏ä‡∏±‡πà‡∏ô',
        isActive: true
      }
    }),
    prisma.category.create({
      data: {
        name: '‡∏≠‡∏¥‡πÄ‡∏•‡πá‡∏Å‡∏ó‡∏£‡∏≠‡∏ô‡∏¥‡∏Å‡∏™‡πå',
        slug: 'electronics',
        description: '‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏¥‡πÄ‡∏•‡πá‡∏Å‡∏ó‡∏£‡∏≠‡∏ô‡∏¥‡∏Å‡∏™‡πå',
        isActive: true
      }
    }),
    prisma.category.create({
      data: {
        name: '‡∏Ç‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏ö‡πâ‡∏≤‡∏ô',
        slug: 'home',
        description: '‡∏Ç‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á',
        isActive: true
      }
    })
  ])

  console.log('‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß')

  // ‡∏™‡∏£‡πâ‡∏≤‡∏á Brands
  const brands = await Promise.all([
    prisma.brand.create({
      data: {
        name: 'Samsung',
        slug: 'samsung',
        description: 'Samsung Electronics',
        website: 'https://samsung.com',
        isActive: true
      }
    }),
    prisma.brand.create({
      data: {
        name: 'Nike',
        slug: 'nike',
        description: 'Nike Sports',
        website: 'https://nike.com',
        isActive: true
      }
    }),
    prisma.brand.create({
      data: {
        name: 'IKEA',
        slug: 'ikea',
        description: 'IKEA Furniture',
        website: 'https://ikea.com',
        isActive: true
      }
    })
  ])

  console.log('‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ö‡∏£‡∏ô‡∏î‡πå‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß')

  // ‡∏™‡∏£‡πâ‡∏≤‡∏á Products
  const products = await Promise.all([
    prisma.product.create({
      data: {
        name: 'Galaxy S24',
        slug: 'galaxy-s24',
        description: 'Samsung Galaxy S24 ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡∏£‡∏∏‡πà‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î',
        sku: 'SAM-S24-001',
        status: 'ACTIVE',
        price: 29900,
        costPrice: 20000,
        comparePrice: 32900,
        quantity: 50,
        categoryId: categories[1].id,
        brandId: brands[0].id
      }
    }),
    prisma.product.create({
      data: {
        name: 'Air Max 270',
        slug: 'air-max-270',
        description: '‡∏£‡∏≠‡∏á‡πÄ‡∏ó‡πâ‡∏≤ Nike Air Max 270',
        sku: 'NIK-AM270-001',
        status: 'ACTIVE',
        price: 4500,
        costPrice: 3000,
        comparePrice: 5500,
        quantity: 30,
        categoryId: categories[0].id,
        brandId: brands[1].id
      }
    }),
    prisma.product.create({
      data: {
        name: 'HEMNES ‡πÇ‡∏ï‡πä‡∏∞‡∏ó‡∏≥‡∏á‡∏≤‡∏ô',
        slug: 'hemnes-desk',
        description: '‡πÇ‡∏ï‡πä‡∏∞‡∏ó‡∏≥‡∏á‡∏≤‡∏ô IKEA HEMNES',
        sku: 'IKE-HEM-001',
        status: 'ACTIVE',
        price: 3990,
        costPrice: 2500,
        comparePrice: 4990,
        quantity: 15,
        categoryId: categories[2].id,
        brandId: brands[2].id
      }
    })
  ])

  console.log('‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß')

  // ‡∏™‡∏£‡πâ‡∏≤‡∏á Customers
  const customers = await Promise.all([
    prisma.customer.create({
      data: {
        email: 'john@example.com',
        firstName: 'John',
        lastName: 'Doe',
        phone: '081-234-5678',
        status: 'ACTIVE',
        segment: 'REGULAR',
        totalSpent: 15000,
        totalOrders: 3
      }
    }),
    prisma.customer.create({
      data: {
        email: 'jane@example.com',
        firstName: 'Jane',
        lastName: 'Smith',
        phone: '082-345-6789',
        status: 'ACTIVE',
        segment: 'VIP',
        totalSpent: 50000,
        totalOrders: 8
      }
    })
  ])

  console.log('‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß')

  // ‡∏™‡∏£‡πâ‡∏≤‡∏á Coupons
  const coupons = await Promise.all([
    prisma.coupon.create({
      data: {
        code: 'WELCOME10',
        name: '‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö',
        description: '‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î 10% ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡πÉ‡∏´‡∏°‡πà',
        type: 'PERCENTAGE',
        value: 10,
        status: 'ACTIVE',
        usageLimit: 100,
        usageCount: 25,
        minimumAmount: 1000,
        startsAt: new Date('2024-01-01'),
        expiresAt: new Date('2024-12-31')
      }
    }),
    prisma.coupon.create({
      data: {
        code: 'SAVE500',
        name: '‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î 500 ‡∏ö‡∏≤‡∏ó',
        description: '‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î 500 ‡∏ö‡∏≤‡∏ó',
        type: 'FIXED',
        value: 500,
        status: 'ACTIVE',
        usageLimit: 50,
        usageCount: 10,
        minimumAmount: 5000,
        startsAt: new Date('2024-01-01'),
        expiresAt: new Date('2024-06-30')
      }
    })
  ])

  console.log('‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß')

  // ‡∏™‡∏£‡πâ‡∏≤‡∏á Orders
  const orders = await Promise.all([
    prisma.order.create({
      data: {
        orderNumber: 'ORD-2024-001',
        status: 'COMPLETED',
        customerId: customers[0].id,
        customerEmail: customers[0].email,
        shippingAddress: {
          firstName: 'John',
          lastName: 'Doe',
          address1: '123 ‡∏ñ‡∏ô‡∏ô‡∏™‡∏∏‡∏Ç‡∏∏‡∏°‡∏ß‡∏¥‡∏ó',
          city: '‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø',
          province: '‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏°‡∏´‡∏≤‡∏ô‡∏Ñ‡∏£',
          postalCode: '10110',
          country: '‡πÑ‡∏ó‡∏¢'
        },
        subtotal: 29900,
        taxAmount: 2093,
        shippingAmount: 100,
        discountAmount: 2990,
        totalAmount: 29103,
        channel: 'web',
        placedAt: new Date()
      }
    }),
    prisma.order.create({
      data: {
        orderNumber: 'ORD-2024-002',
        status: 'PENDING',
        customerId: customers[1].id,
        customerEmail: customers[1].email,
        shippingAddress: {
          firstName: 'Jane',
          lastName: 'Smith',
          address1: '456 ‡∏ñ‡∏ô‡∏ô‡∏û‡∏´‡∏•‡πÇ‡∏¢‡∏ò‡∏¥‡∏ô',
          city: '‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø',
          province: '‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏°‡∏´‡∏≤‡∏ô‡∏Ñ‡∏£',
          postalCode: '10400',
          country: '‡πÑ‡∏ó‡∏¢'
        },
        subtotal: 4500,
        taxAmount: 315,
        shippingAmount: 50,
        discountAmount: 0,
        totalAmount: 4865,
        channel: 'mobile',
        placedAt: new Date()
      }
    })
  ])

  // ‡∏™‡∏£‡πâ‡∏≤‡∏á Order Items
  await Promise.all([
    prisma.orderItem.create({
      data: {
        orderId: orders[0].id,
        productId: products[0].id,
        quantity: 1,
        price: 29900,
        totalAmount: 29900,
        productName: products[0].name,
        productSku: products[0].sku
      }
    }),
    prisma.orderItem.create({
      data: {
        orderId: orders[1].id,
        productId: products[1].id,
        quantity: 1,
        price: 4500,
        totalAmount: 4500,
        productName: products[1].name,
        productSku: products[1].sku
      }
    })
  ])

  // ‡∏™‡∏£‡πâ‡∏≤‡∏á Payments
  await Promise.all([
    prisma.payment.create({
      data: {
        orderId: orders[0].id,
        amount: 29103,
        method: 'STRIPE',
        status: 'COMPLETED',
        currency: 'THB',
        processedAt: new Date()
      }
    }),
    prisma.payment.create({
      data: {
        orderId: orders[1].id,
        amount: 4865,
        method: 'BANK_TRANSFER',
        status: 'PENDING',
        currency: 'THB'
      }
    })
  ])

  console.log('‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß')

  console.log('üéâ Seeding ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå!')
  console.log('')
  console.log('üìä ‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á:')
  console.log(`üë• ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ: ${await prisma.user.count()} ‡∏Ñ‡∏ô`)
  console.log(`üè∑Ô∏è ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà: ${await prisma.category.count()} ‡∏´‡∏°‡∏ß‡∏î`)
  console.log(`üè¢ ‡πÅ‡∏ö‡∏£‡∏ô‡∏î‡πå: ${await prisma.brand.count()} ‡πÅ‡∏ö‡∏£‡∏ô‡∏î‡πå`)
  console.log(`üì¶ ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤: ${await prisma.product.count()} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`)
  console.log(`üë§ ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤: ${await prisma.customer.count()} ‡∏Ñ‡∏ô`)
  console.log(`üõí ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠: ${await prisma.order.count()} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`)
  console.log(`üé´ ‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á: ${await prisma.coupon.count()} ‡πÉ‡∏ö`)
  console.log('')
  console.log('üîë ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö:')
  console.log('Admin: admin@example.com / admin123')
  console.log('Manager: manager@example.com / admin123')
  console.log('Staff: staff@example.com / admin123')
}

main()
  .catch((e) => {
    console.error('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£ seed:', e)
    process.exit(1)
  })
  .finally(async () => {
    await prisma.$disconnect()
  })
